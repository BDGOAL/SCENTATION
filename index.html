<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCENTATION</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; background: #1A1A1A; }
        #root { width: 2160px; height: 3840px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // =========================================================
        // 此區塊為技術修復：將您 import 的外部邏輯內置，確保不報錯
        // =========================================================
        const calcMbti = (answers) => {
            const counts = { N: 0, S: 0, J: 0, P: 0, T: 0, F: 0, E: 0, I: 0 };
            answers.forEach(a => {
                if (a.question === 1) a.answer === 'A' ? counts.N++ : counts.S++;
                if (a.question === 2) a.answer === 'A' ? counts.T++ : counts.F++;
                if (a.question === 3) a.answer === 'A' ? counts.J++ : counts.P++;
                if (a.question === 4) a.answer === 'A' ? counts.E++ : counts.I++;
            });
            return (counts.E >= counts.I ? 'E' : 'I') + (counts.N >= counts.S ? 'N' : 'S') + (counts.T >= counts.F ? 'T' : 'F') + (counts.J >= counts.P ? 'J' : 'P');
        };

        const getCategoryKey = (mbti) => {
            if (mbti.includes('N') && mbti.includes('T')) return 'NT';
            if (mbti.includes('N') && mbti.includes('F')) return 'NF';
            if (mbti.includes('S') && mbti.includes('J')) return 'SJ';
            if (mbti.includes('S') && mbti.includes('P')) return 'SP';
            return 'NT';
        };

        const { useState, useCallback, useEffect } = React;

        // =========================================================
        // 以下完全保留您的原始設計與變數定義
        // =========================================================
        const logoImage = 'https://raw.githubusercontent.com/BDGOAL/SCENTATION/refs/heads/main/Scentation_logo_2025.05.26_v1_%E7%99%BD%E5%AD%97_A4.png';
        const iconA = 'https://raw.githubusercontent.com/BDGOAL/SCENTATION/refs/heads/main/iconA.png';
        const iconB = 'https://raw.githubusercontent.com/BDGOAL/SCENTATION/refs/heads/main/IconB.png';

        const productImages = {
            NT_Aventus: 'https://raw.githubusercontent.com/BDGOAL/SCENTATION/refs/heads/main/k11%20musea%20product%20image_Creed_Aventus%20Collection-Aventus_edp.jpg',
            SJ_ForHerEDT: 'https://raw.githubusercontent.com/BDGOAL/SCENTATION/refs/heads/main/k11%20musea%20product%20image_narciso%20rodriguez_For%20Her_edt.jpg',
            NF_Ani: 'https://raw.githubusercontent.com/BDGOAL/SCENTATION/refs/heads/main/k11%20musea%20product%20image_Nishane_Ani_Extrait.jpg',
            SP_BlackAfgano: 'https://raw.githubusercontent.com/BDGOAL/SCENTATION/refs/heads/main/k11%20musea%20product%20image_Nasomatto_Black%20Afgano_Extrait%20de%20parfum.jpg',
        };

        const translations = {
            'zh-TW': {
                intro: { title: '探索您的香氣密碼', description: '於瞬息萬變的都會節奏中，您的香氣定義了您的氣場。\n迅速剖析核心人格特質，精準推薦最能彰顯您個人魅力的香調。', button: '按此啟動 探索香氣' },
                header: { tagline: '為您的非凡風格，尋覓您的品味哲學。' },
                nameInput: { title: '請輸入您的姓名', subtitle: '讓我們為您量身打造香氣體驗', button: '開始測試', placeholder: '輸入姓名' },
                exit: '✕', restart: '重新探索',
                resultsMap: {
                    NT: { category: '分析家', desc: '作為邏輯至上、追求效率與複雜性的分析家。', fragrance: '木質調 / 西普調 / 芳香調', products: [{brand: 'Creed', name: 'Aventus', image: productImages.NT_Aventus, description: '擅長統籌全局與制定策略的你...'}]},
                    NF: { category: '外交官', desc: '作為情緒豐富的外交官。', fragrance: '東方調 / 花香調', products: [{brand: 'Nishane', name: 'Ani', image: productImages.NF_Ani, description: '重視情感連結與關係溫度的你...'}]},
                    SJ: { category: '守護者', desc: '作為守護者，您偏愛清晰穩定。', fragrance: '柑橘調 / 清新麝香', products: [{brand: 'Narciso', name: 'For Her', image: productImages.SJ_ForHerEDT, description: '重視穩定、乾淨與可信度...'}]},
                    SP: { category: '探險家', desc: '作為探險家，您需要充滿活力。', fragrance: '皮革調 / 辛辣調', products: [{brand: 'Nasomatto', name: 'Black Afgano', image: productImages.SP_BlackAfgano, description: '對暗黑美學與實驗性作品好奇...'}]}
                },
                questions: [
                    { id: 1, title: '鑑賞藝術品時，您的目光最先被什麼吸引？', options: [{ key: 'N', text: '作品背後的哲思、藝術家的抽象概念。'}, { key: 'S', text: '作品的材質、精準技法與生動色彩。'}], image: 'https://raw.githubusercontent.com/BDGOAL/SCENTATION/refs/heads/main/1.png', progressWidth: 366 },
                    { id: 2, title: '在緊張的人際衝突中，您認為香氣的作用是什麼？', options: [{ key: 'T', text: '幫助我保持清醒和冷靜。'}, { key: 'F', text: '柔化周圍的氛圍，建立連結。'}], image: 'https://raw.githubusercontent.com/BDGOAL/SCENTATION/refs/heads/main/2.png', progressWidth: 692 },
                    { id: 3, title: '關於您的香氛收藏，哪個描述最貼切？', options: [{ key: 'J', text: '會根據場合與計劃進行精準選擇。'}, { key: 'P', text: '隨心所欲地使用，喜歡即興疊香。'}], image: 'https://raw.githubusercontent.com/BDGOAL/SCENTATION/refs/heads/main/3.png', progressWidth: 1081 },
                    { id: 4, title: '週末晚上，您渴望散發哪一種風格？', options: [{ key: 'E', text: '濃郁、具有魅力且張揚。'}, { key: 'I', text: '內斂、有層次且舒適。'}], image: 'https://raw.githubusercontent.com/BDGOAL/SCENTATION/refs/heads/main/4.png', progressWidth: 1400 }
                ]
            }
        };

        // =========================================================
        // ResultPage 組件 (修復黑畫面關鍵：將 import 的檔案內容直接寫入)
        // =========================================================
        const ResultPage = ({ result, playerName, currentLang, restartQuiz }) => (
            <div className="absolute inset-0 flex flex-col items-center pt-40 px-20">
                <p className="text-white text-[60px] mb-10">親愛的 {playerName},</p>
                <h1 className="text-[#D4AF37] text-[120px] font-bold mb-10 tracking-widest">{result.resultData.category}</h1>
                <h2 className="text-white text-[130px] font-bold mb-10 opacity-50 uppercase">{result.mbtiType}</h2>
                <p className="text-white text-[50px] text-center mb-20 leading-relaxed px-10">{result.resultData.desc}</p>
                <div className="bg-white p-10 rounded-[40px] mb-20">
                    <img src={`https://chart.googleapis.com/chart?cht=qr&chs=400x400&chl=${encodeURIComponent('https://scentation.com/share?name='+playerName+'&type='+result.mbtiType)}`} className="w-[500px] h-[500px]" />
                </div>
                <button onClick={restartQuiz} className="w-[900px] h-[200px] bg-[#B8860B] text-white text-[80px] font-bold rounded-full">重新探索</button>
            </div>
        );

        // =========================================================
        // 主 App 組件 (結構完全沿用您的設計)
        // =========================================================
        function App() {
            const [currentPage, setCurrentPage] = useState('intro');
            const [playerName, setPlayerName] = useState('');
            const [answers, setAnswers] = useState([]);
            const [result, setResult] = useState(null);

            const texts = translations['zh-TW'];
            const keyboard = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");

            const handleAnswer = (qId, key, isLast) => {
                const newAns = [...answers, { question: qId, answer: key }];
                setAnswers(newAns);
                if (isLast) {
                    const mbti = calcMbti(newAns);
                    setResult({ mbtiType: mbti, resultData: texts.resultsMap[getCategoryKey(mbti)] });
                    setCurrentPage('result');
                } else {
                    setCurrentPage(qId + 1);
                }
            };

            return (
                <div className="app-container relative bg-[#1A1A1A]">
                    <img src="https://raw.githubusercontent.com/BDGOAL/SCENTATION/refs/heads/main/pattern.png" className="absolute inset-0 w-full h-full object-cover opacity-30" />
                    
                    {/* 依照您的定製佈局 */}
                    <div className="absolute left-[220px] top-[222px] w-[1722px] h-[3392px] bg-gradient-to-b from-[#1A1A1A] to-[#2B2B2B] rounded-[35px] shadow-[0px_0px_40px_#D4AF37] overflow-hidden">
                        
                        <div className="flex justify-center pt-20">
                            <img src={logoImage} className="w-[75%] object-contain" />
                        </div>

                        {currentPage === 'intro' && (
                            <div className="flex flex-col items-center pt-40 px-20 text-center">
                                <h1 className="text-[#D4AF37] text-[150px] font-bold mb-10">{texts.intro.title}</h1>
                                <p className="text-[#D4AF37] text-[40px] mb-20 leading-snug">{texts.intro.description}</p>
                                <img src="https://raw.githubusercontent.com/BDGOAL/SCENTATION/refs/heads/main/ChatGPT%20Image%202025%E5%B9%B412%E6%9C%8815%E6%97%A5%20%E4%B8%8B%E5%8D%8803_37_10%201%20(1).png" className="w-[1148px] h-[1200px] object-cover rounded-[25px] mb-20" />
                                <button onClick={() => setCurrentPage('nameInput')} className="w-[923px] h-[210px] bg-[#B8860B] text-white text-[96px] font-bold rounded-[25px]">按此啟動</button>
                            </div>
                        )}

                        {currentPage === 'nameInput' && (
                            <div className="flex flex-col items-center pt-60 px-20">
                                <h2 className="text-[#B8860B] text-[130px] font-bold mb-20">{texts.nameInput.title}</h2>
                                <div className="w-[900px] h-[140px] bg-white rounded-[25px] flex items-center justify-center text-[80px] font-bold text-black mb-32">
                                    {playerName || texts.nameInput.placeholder}
                                </div>
                                <div className="flex flex-wrap justify-center gap-6">
                                    {keyboard.map(l => (
                                        <button key={l} onClick={() => setPlayerName(p => (p+l).slice(0,10))} className="w-[150px] h-[150px] bg-white/10 border-2 border-[#B8860B] text-white text-6xl rounded-3xl active:bg-[#B8860B]">{l}</button>
                                    ))}
                                    <button onClick={() => setPlayerName(p => p.slice(0,-1))} className="w-[350px] h-[150px] bg-red-900/50 border-2 border-red-500 text-white text-5xl rounded-3xl">DEL</button>
                                    <button onClick={() => playerName && setCurrentPage(1)} className="w-[350px] h-[150px] bg-green-700/50 border-2 border-green-500 text-white text-5xl rounded-3xl">START</button>
                                </div>
                            </div>
                        )}

                        {typeof currentPage === 'number' && (
                            <div className="flex flex-col items-center pt-40 px-20 text-center">
                                <h2 className="text-[#B8860B] text-[96px] font-bold mb-20 leading-tight">{texts.questions[currentPage-1].title}</h2>
                                <img src={texts.questions[currentPage-1].image} className="w-[1300px] h-[600px] object-cover rounded-[25px] mb-20 shadow-2xl" />
                                <div className="flex flex-col gap-10 w-[1400px]">
                                    {texts.questions[currentPage-1].options.map(opt => (
                                        <button key={opt.key} onClick={() => handleAnswer(currentPage, opt.key, currentPage === 4)} className="w-full h-[240px] border-8 border-white rounded-[25px] text-white text-[70px] flex items-center justify-center px-10 leading-snug">
                                            {opt.text}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        )}

                        {currentPage === 'result' && (
                            <ResultPage result={result} playerName={playerName} restartQuiz={() => setCurrentPage('intro')} />
                        )}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
